<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ì˜¤ë²„í´ëŸ­ ì‹œë®¬ë ˆì´í„° (ì¹˜ì´ì½˜ ì™„ì „íŒ + ì‚¬ìš©ì í™•ë¥  ì¡°ì •)</title>
  <style>
    body { font-family: Inter, Arial, sans-serif; background:#f3f4f6; color:#111827; margin:0; padding:20px; }
    .container { max-width:980px; margin:0 auto; background:#fff; border-radius:12px; padding:20px; box-shadow:0 6px 18px rgba(15,23,42,0.08); }
    h1{font-size:22px; margin:0 0 12px;}
    section{margin-bottom:16px; border-radius:10px; padding:12px; background:#fbfeff; border:1px solid #eef2f7;}
    button{padding:8px 10px;border-radius:8px;border:0;cursor:pointer;margin-right:8px;}
    .btn-blue{background:#2563eb;color:#fff;}
    .btn-green{background:#16a34a;color:#fff;}
    .btn-outline{background:#fff;border:1px solid #e5e7eb;color:#111;}
    .log{max-height:220px;overflow:auto;background:#f8fafc;padding:8px;border-radius:6px;border:1px solid #eef2f7;}
    .row{display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid #eef2f7;}
    .row:last-child{border-bottom:0;}
    .small{font-size:12px;color:#6b7280;}
    footer{font-size:12px;color:#6b7280;margin-top:8px;text-align:center;}
    .overclock-text { color:#1d4ed8; font-weight:800; text-shadow:0 0 8px rgba(37,99,235,0.6), 0 0 12px rgba(37,99,235,0.4); letter-spacing:1px; }
    .result-card { margin-top:14px; display:inline-block; background: linear-gradient(180deg, rgba(255,255,255,0.9), rgba(250,250,250,0.85)); padding:10px; border-radius:12px; border:1px solid #e6eef8; box-shadow: 0 8px 24px rgba(29,78,216,0.06); text-align:center; min-width:140px; }
    .result-img { width:120px; height:120px; object-fit:cover; border-radius:12px; display:block; margin:0 auto; transform:scale(.92); opacity:0; animation: popIn 520ms cubic-bezier(.2,.9,.2,1) forwards; border: 2px solid rgba(0,0,0,0.06); background: #fff; }
    .result-caption { margin-top:8px; font-weight:700; font-size:14px; }
    @keyframes popIn { 0% { opacity:0; transform: scale(.8) rotate(-6deg); filter: blur(4px); } 60% { opacity:1; transform: scale(1.06) rotate(3deg); filter: blur(0px); } 100% { opacity:1; transform: scale(1) rotate(0deg); filter: blur(0px); } }
    .result-success { color:#16a34a; }
    .result-fail { color:#dc2626; }
    input[type=number] { width:60px; padding:4px; border:1px solid #ccc; border-radius:6px; }
    @media (max-width:600px) { .result-img { width:96px; height:96px; } }
  </style>
</head>
<body>
  <div class="container" id="root"></div>

  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script crossorigin src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState } = React;

    const displayStage = (stage, withStyle=false) => {
      const map = {9:"9",10:"ì˜¤ë²„í´ëŸ­",11:"â… ",12:"â…¡",13:"â…¢",14:"â…£",15:"â…¤"};
      const label = map[stage] || stage.toString();
      if (withStyle && stage === 10) return <span className="overclock-text">{label}</span>;
      return label;
    };

    function OverclockStageSimulator() {
      const stages = {9:40,10:35,11:20,12:18,13:15,14:10,15:0};
      const pityIncrement = 5;
      const baseStart = 9;

      const successImage = "ì„±ê³µ.png";
      const failImage = "ì‹¤íŒ¨.png";
      const maxImage = "15ê°•.PNG";

      const [stage, setStage] = useState(baseStart);
      const [startStage, setStartStage] = useState(baseStart);
      const [pityMap, setPityMap] = useState({9:0,10:0,11:0,12:0,13:0,14:0,15:0});
      const [attemptLog, setAttemptLog] = useState([]);
      const [attemptCount, setAttemptCount] = useState(0);
      const [completed, setCompleted] = useState(false);
      const [resultImage, setResultImage] = useState(null);
      const [resultLabel, setResultLabel] = useState("");
      const [resultClass, setResultClass] = useState("");
      const [customPity, setCustomPity] = useState({9:0,10:0,11:0,12:0,13:0,14:0,15:0});

      const baseChance = stages[stage] ?? 0;
      const currentPity = pityMap[stage] ?? 0;
      const totalChance = Math.min(baseChance + currentPity, 100);

      function showResult(success, isMax=false) {
        if (isMax) {
          setResultImage(maxImage);
          setResultLabel("ì¶•í•˜í•´ ğŸ‰ â…¤ë‹¨ê³„ ë‹¬ì„±!");
          setResultClass("result-success");
          return;
        }
        if (success) {
          setResultImage(successImage);
          setResultLabel("ì„±ê³µ ğŸ‰");
          setResultClass("result-success");
        } else {
          setResultImage(failImage);
          setResultLabel("ì‹¤íŒ¨ ğŸ’¥");
          setResultClass("result-fail");
        }
      }

      function doAttempt() {
        if (completed) return;
        const roll = Math.random() * 100;
        const success = roll < totalChance;
        let nextStage = stage;
        let newPityMap = {...pityMap};

        if (success) {
          newPityMap[stage] = 0;
          nextStage = stage + 1;
          if (nextStage >= 15) {
            nextStage = 15;
            showResult(true, true);
            setCompleted(true);
          } else showResult(true);
        } else {
          newPityMap[stage] = Math.min((newPityMap[stage] ?? 0) + pityIncrement, 100);
          nextStage = baseStart;
          showResult(false);
        }

        const resultText = success ? "ì„±ê³µ" : "ì˜¤ë²„í´ëŸ­ì— ì‹¤íŒ¨í•´ ë©œíŠ¸ë‹¤ìš´ ìƒíƒœê°€ ë˜ì—ˆìŠµë‹ˆë‹¤ (ë‹¨ê³„ ì´ˆê¸°í™”)";
        const newAttempt = { attempt: attemptCount + 1, stage: displayStage(stage), chance: totalChance.toFixed(2), roll: roll.toFixed(2), result: resultText };

        setAttemptCount(c => c + 1);
        setAttemptLog(l => [newAttempt, ...l].slice(0,200));
        setPityMap(newPityMap);
        setStage(nextStage);
      }

      function reset() {
        setStage(startStage);
        setPityMap({9:0,10:0,11:0,12:0,13:0,14:0,15:0});
        setAttemptCount(0);
        setAttemptLog([]);
        setCompleted(false);
        setResultImage(null);
        setResultLabel("");
        setResultClass("");
      }

      // ì‚¬ìš©ì ì§€ì • í™•ë¥  ë°˜ì˜
      function applyCustomPity() {
        setPityMap(prev => {
          const updated = {...prev};
          Object.keys(customPity).forEach(k=>{
            updated[k] = Math.min(Math.max(Number(customPity[k]) || 0, 0), 100);
          });
          return updated;
        });
      }

      return (
        <div>
          <h1>ì˜¤ë²„í´ëŸ­(ê°•í™”) ì‹œë®¬ë ˆì´í„° â€” ì‚¬ìš©ì í™•ë¥  ì¡°ì •íŒ</h1>

          <section>
            <div className="small">ì‹œì‘í•  ë‹¨ê³„ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
            <select value={startStage} onChange={e=>setStartStage(Number(e.target.value))} style={{padding:"6px 10px",borderRadius:"6px",border:"1px solid #ccc",marginRight:"8px"}}>
              {Object.keys(stages).map(s=>(
                <option key={s} value={s}>{displayStage(Number(s))}</option>
              ))}
            </select>
            <button className="btn-blue" onClick={()=>{reset(); setStage(startStage);}}>ì‹œì‘í•˜ê¸°</button>
          </section>

          <section style={{textAlign:'center'}}>
            <div className="small">í˜„ì¬ ë‹¨ê³„</div>
            <div style={{fontSize:24,fontWeight:700}}>
              {displayStage(stage,true)}ë‹¨ê³„ {completed && '(ìµœëŒ€ ê°•í™” ì™„ë£Œ)'}
            </div>
            <div className="small" style={{marginTop:6}}>
              ê¸°ë³¸ í™•ë¥ : {stages[stage]}% | ì¶”ê°€ í™•ë¥ : {pityMap[stage]}% | ì´ í™•ë¥ : {Math.min(stages[stage]+pityMap[stage],100).toFixed(2)}%
            </div>

            {resultImage && (
              <div className="result-card">
                <img className="result-img" src={resultImage} alt={resultLabel}/>
                <div className={`result-caption ${resultClass}`}>{resultLabel}</div>
              </div>
            )}
          </section>

          <section>
            <h3 className="small" style={{marginBottom:6}}>ğŸ“Š ë‹¨ê³„ë³„ ëˆ„ì  í™•ë¥ í‘œ</h3>
            <table style={{width:"100%",borderCollapse:"collapse",fontSize:13}}>
              <thead>
                <tr style={{background:"#f1f5f9"}}>
                  <th style={{padding:"6px",border:"1px solid #e5e7eb"}}>ë‹¨ê³„</th>
                  <th style={{padding:"6px",border:"1px solid #e5e7eb"}}>ê¸°ë³¸ í™•ë¥ </th>
                  <th style={{padding:"6px",border:"1px solid #e5e7eb"}}>ëˆ„ì  ì¶”ê°€ í™•ë¥ </th>
                  <th style={{padding:"6px",border:"1px solid #e5e7eb"}}>ì‚¬ìš©ì ì§€ì •(%)</th>
                  <th style={{padding:"6px",border:"1px solid #e5e7eb"}}>ì´ í™•ë¥ </th>
                </tr>
              </thead>
              <tbody>
                {Object.keys(stages).map(s=>(
                  <tr key={s} style={{background:Number(s)===stage ? "#e0f2fe" : "white"}}>
                    <td style={{padding:"6px",border:"1px solid #e5e7eb",fontWeight:600}}>
                      {Number(s)===10 ? <span className="overclock-text">{displayStage(Number(s))}</span> : displayStage(Number(s))}
                    </td>
                    <td style={{padding:"6px",border:"1px solid #e5e7eb"}}>{stages[s]}%</td>
                    <td style={{padding:"6px",border:"1px solid #e5e7eb"}}>{pityMap[s]}%</td>
                    <td style={{padding:"6px",border:"1px solid #e5e7eb"}}>
                      <input type="number" value={customPity[s]} onChange={e=>setCustomPity({...customPity,[s]:e.target.value})} min="0" max="100"/> 
                    </td>
                    <td style={{padding:"6px",border:"1px solid #e5e7eb"}}>{Math.min(stages[s]+pityMap[s],100)}%</td>
                  </tr>
                ))}
              </tbody>
            </table>
            <div style={{marginTop:"10px",textAlign:"right"}}>
              <button className="btn-green" onClick={applyCustomPity}>ì¶”ê°€ í™•ë¥  ì ìš©</button>
            </div>
          </section>

          <section>
            <button className="btn-blue" onClick={doAttempt} disabled={completed}>í•œ ë²ˆ ì‹œë„</button>
            <button className="btn-outline" onClick={reset}>ë¦¬ì…‹</button>
            <div style={{marginTop:12}}>
              <div className="small">ì´ ì‹œë„ íšŸìˆ˜: {attemptCount}</div>
            </div>
          </section>

          <section>
            <h3 className="small">ìµœê·¼ ì‹œë„ ê¸°ë¡</h3>
            <div className="log">
              {attemptLog.length===0 && <div className="small">ì•„ì§ ì‹œë„ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.</div>}
              {attemptLog.map((a,idx)=>(
                <div className="row" key={idx}>
                  <div>#{a.attempt} â€” {a.stage}ë‹¨ê³„ | í™•ë¥ : {a.chance}% (ë¡¤: {a.roll})</div>
                  <div style={{color:a.result.includes("ì‹¤íŒ¨")?'#dc2626':'#16a34a',fontWeight:600}}>{a.result}</div>
                </div>
              ))}
            </div>
          </section>

          <footer>
            ê°•í™” ì‹¤íŒ¨ ì‹œ 9ë‹¨ê³„ë¡œ ì´ˆê¸°í™”ë˜ë©°, í•´ë‹¹ ë‹¨ê³„ì˜ í™•ë¥ ì€ +5% ëˆ„ì ë©ë‹ˆë‹¤.<br/>
            ì‚¬ìš©ì ì…ë ¥ì„ í†µí•´ ê° ë‹¨ê³„ì˜ ëˆ„ì  ì¶”ê°€ í™•ë¥ ì„ ì§ì ‘ ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          </footer>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<OverclockStageSimulator/>);
  </script>
</body>
</html>
